{% extends "base.html" %}
{% block title %}–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç{% endblock %}

{% block extra_css %}
<style>
  .dashboard-header {
    background: linear-gradient(135deg, #f7e7de, #fffaf7);
    border-radius: 1.5rem;
    padding: 2rem;
    box-shadow: 0 6px 18px rgba(163, 107, 94, 0.15);
    margin-bottom: 2rem;
  }
  .dashboard-header h2 {
    font-weight: 700;
    color: #7b5a50;
  }
  .stat-card {
    border-radius: 1rem;
    background: #fff;
    padding: 1.5rem;
    box-shadow: 0 4px 14px rgba(163, 107, 94, 0.12);
    text-align: center;
    transition: transform 0.2s ease;
  }
  .stat-card:hover {
    transform: translateY(-4px);
  }
  .stat-icon {
    font-size: 2rem;
    color: #a36b5e;
    margin-bottom: 0.5rem;
  }
  .note-card {
    border-radius: 1rem;
    background: #fffdf9;
    box-shadow: 0 6px 18px rgba(163, 107, 94, 0.12);
    transition: box-shadow 0.3s ease, transform 0.2s ease;
    cursor: pointer;
  }
  .note-card:hover {
    box-shadow: 0 12px 36px rgba(163, 107, 94, 0.24);
    transform: translateY(-3px);
  }
  .note-header {
    font-weight: 600;
    color: #7b5a50;
  }
  .note-content-preview {
    color: #5a4d47;
  }
  .note-link {
    text-decoration: none;
    color: #a36b5e;
    font-weight: 600;
  }
  .note-link:hover {
    text-decoration: underline;
    color: #7b5a50;
  }
  .no-notes {
    font-style: italic;
    color: #a08b7a;
    text-align: center;
    padding: 2rem 0;
  }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">

  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <div class="dashboard-header">
    <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span style="color: #a36b5e;">{{ user.full_name }}</span>! 
      <i class="bi bi-person-circle"></i>
    </h2>
    <p class="text-muted mb-0">–†–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å —Å–Ω–æ–≤–∞ üå∏ –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –æ–±—É—á–µ–Ω–∏–µ, –¥–æ–±–∞–≤–ª—è–π—Ç–µ –∑–∞–º–µ—Ç–∫–∏ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å.</p>
  </div>


  <!-- –ó–∞–º–µ—Ç–∫–∏ -->
  <h4 class="mb-3">üóíÔ∏è –í–∞—à–∏ –∑–∞–º–µ—Ç–∫–∏</h4>

  {% if notes %}
    <div class="row g-3">
      {% for note in notes %}
      <div class="col-md-6 col-lg-4">
        <a href="/lessons/{{ note.lesson_id }}" class="note-link">
          <div class="card note-card p-3 h-100 d-flex flex-column justify-content-between">
            <div>
              <h5 class="note-header mb-2">
                <i class="bi bi-journal-text me-2"></i>{{ note.lesson_title }}
              </h5>
              <p class="note-content-preview mb-0">
                {{ note.content[:120] }}{% if note.content|length > 120 %}...{% endif %}
              </p>
            </div>
            <small class="text-muted mt-3 d-block text-end">
              <i class="bi bi-clock-history"></i>
              {{ note.created_at.strftime('%d.%m.%Y, %H:%M') if note.created_at else '' }}
            </small>
          </div>
        </a>
      </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="no-notes">
      <i class="bi bi-clipboard-x" style="font-size: 2rem;"></i>
      <p>–ó–∞–º–µ—Ç–æ–∫ –ø–æ–∫–∞ –Ω–µ—Ç. –ù–∞—á–Ω–∏—Ç–µ —É—á–∏—Ç—å—Å—è –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –∑–∞–º–µ—Ç–∫–∏ –∫ —É—Ä–æ–∫–∞–º!</p>
    </div>
  {% endif %}
  <!-- –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —É—Ä–æ–∫ -->
{% if current_lesson %}
<h4 class="mb-3">‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ</h4>
<a href="/lessons/{{ current_lesson.id }}" class="text-decoration-none">
  <div class="card note-card p-4 mb-4 d-flex justify-content-between align-items-center" 
       style="border-radius: 1.5rem; background: linear-gradient(135deg, #ffe5d4, #fff7f0); 
              box-shadow: 0 6px 18px rgba(163, 107, 94, 0.15); transition: transform 0.2s ease;">
    <div>
      <h5 class="note-header mb-1" style="font-weight: 700; color: #a36b5e;">
        <i class="bi bi-play-circle me-2"></i>{{ current_lesson.title }}
      </h5>
      <p class="text-muted mb-0" style="color: #7b5a50;">–í—ã –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å –Ω–∞ —ç—Ç–æ–º —É—Ä–æ–∫–µ</p>
    </div>
    <div>
      <i class="bi bi-arrow-right-circle" style="font-size: 2rem; color: #a36b5e;"></i>
    </div>
  </div>
</a>
{% endif %}

</div>
{% endblock %}
